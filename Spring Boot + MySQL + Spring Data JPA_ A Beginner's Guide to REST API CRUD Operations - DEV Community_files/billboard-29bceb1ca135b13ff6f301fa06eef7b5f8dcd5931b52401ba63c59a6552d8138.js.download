(()=>{function e(){let e=document.querySelectorAll("button[id^=sponsorship-dropdown-trigger-]");e.length&&e.forEach((e=>{t(e);let o=e.getAttribute("aria-controls");e&&"true"!==e.dataset.initialized&&(S({triggerElementId:e.id,dropdownContentId:o}),e.dataset.initialized="true");let n=e.closest(".popover-billboard");n&&e.getBoundingClientRect().top>window.innerHeight/2&&n.classList.add("popover-billboard--menuopenupwards")})),n();let r=document.querySelectorAll("button[id^=sponsorship-close-trigger-]");r.length&&r.forEach((e=>{e.addEventListener("click",(()=>{o(e)})),e.closest(".popover-billboard")&&document.addEventListener("click",(t=>{t.target.closest(".crayons-article__header")&&"none"!==document.querySelector(".popover-billboard").style.display&&t.preventDefault(),t.target.closest(".js-billboard")||o(e)}))}))}function t(e){e.closest(".js-billboard").clientHeight<220&&(e.closest(".js-billboard").style.overflowY="revert")}function o(e){let t=e.closest(".js-billboard").dataset.dismissalSku;if(e.closest(".js-billboard").style.display="none",localStorage&&t&&t.length>0){let e=JSON.parse(localStorage.getItem("dismissal_skus_triggered"))||[];e.includes(t)||(e.push(t),localStorage.setItem("dismissal_skus_triggered",JSON.stringify(e)))}}function n(){let e=document.body.dataset.user;if(e)try{JSON.parse(e).admin&&document.querySelectorAll(".js-admin-billboard-link").forEach((e=>{e.classList.remove("hidden")}))}catch(e){console.warn("Error parsing user data for admin billboard links:",e)}}function r(e){let t,o,n,r,a,i=e.getElementsByTagName("script");for(a=0;a<i.length;a++)if(t=i[a],t){o=document.createElement("script");for(let e=0;e<t.attributes.length;e++)o.setAttribute(t.attributes[e].name,t.attributes[e].value);o.textContent=t.textContent,n=t.parentNode,r=t.nextSibling,n.removeChild(t),n.insertBefore(o,r)}}function a(e){e.querySelector(".js-billboard")&&"delayed"===e.querySelector(".js-billboard").dataset.special&&(e.classList.add("hidden"),setTimeout((()=>{l()}),1e4))}function i(){let e=new IntersectionObserver((e=>{e.forEach((e=>{if(e.isIntersecting){let t=e.target;e.intersectionRatio>=.25&&setTimeout((()=>{d(t)}),200)}}))}),{root:null,rootMargin:"0px",threshold:.25});document.querySelectorAll("[data-display-unit]").forEach((t=>{let o=window.location.pathname;e.observe(t),t.removeEventListener("click",s,!1),t.addEventListener("click",(()=>s(t,event,o)))}))}function l(){document.querySelectorAll("[data-special='delayed']").forEach((e=>{e.closest(".hidden").classList.remove("hidden")}))}function d(e){let t=/bot|google|baidu|bing|msn|duckduckbot|teoma|slurp|yandex/i.test(navigator.userAgent),o=e.dataset.impressionRecorded;if(t||o)return;let n=document.querySelector("meta[name='csrf-token']"),r=n&&n.getAttribute("content"),a={billboard_event:{billboard_id:e.dataset.id,context_type:e.dataset.contextType,category:e.dataset.categoryImpression,article_id:e.dataset.articleId}};window.fetch("/bb_tabulations",{method:"POST",headers:{"X-CSRF-Token":r,"Content-Type":"application/json"},body:JSON.stringify(a),credentials:"same-origin"}).catch((e=>console.error(e))),e.dataset.impressionRecorded=!0}function s(e,t,o){if(!t.target.closest("a"))return;let n={billboard_event:{billboard_id:e.dataset.id,context_type:e.dataset.contextType,category:e.dataset.categoryClick,article_id:e.dataset.articleId}};if(localStorage){let e=localStorage.getItem("last_interacted_billboard");if(e)try{let t=JSON.parse(e);if(t.billboard_event&&t.billboard_event.billboard_id===n.billboard_event.billboard_id&&t.path===o)return}catch{}n.path=o,n.time=new Date,localStorage.setItem("last_interacted_billboard",JSON.stringify(n))}let r=/bot|google|baidu|bing|msn|duckduckbot|teoma|slurp|yandex/i.test(navigator.userAgent),a=e.dataset.clickRecorded;if(r||a)return;let i=document.querySelector("meta[name='csrf-token']"),l=i&&i.getAttribute("content");window.fetch("/bb_tabulations",{method:"POST",headers:{"X-CSRF-Token":l,"Content-Type":"application/json"},body:JSON.stringify(n),credentials:"same-origin"}),e.dataset.clickRecorded=!0}async function c(){let e=[...document.getElementsByClassName("js-billboard-container")].map(u);await Promise.all(e)}async function u(t){var o;let{asyncUrl:n}=t.dataset,l=window.location.href.split("?")[1],d=localStorage.getItem("cookie_status");if(l&&l.includes("bb_test_placement_area")&&(n=`${n}?${l}`),"allowed"===d&&(n+=(n.includes("?")?"&":"?")+"cookies_allowed=true"),n)try{let d=function(e){e.forEach((e=>{if("attributes"===e.type){let{attributeName:t,target:o}=e;g.has(t)||o.removeAttribute(t)}}))},s=function(e){e.__billboardObserverAttached||(new MutationObserver(d).observe(e,f),e.__billboardObserverAttached=!0)},c=document.getElementById("page-content-inner"),u=c&&"true"===c.dataset.internalNav,b=navigator.userAgent.includes("Forem");if(null!=n&&n.includes("post_fixed_bottom")&&(null!=l&&l.includes("context=digest")||u||b))return;let m=await(await window.fetch(n)).text(),p=document.createElement("div");p.innerHTML=m,t.innerHTML="",t.appendChild(p),t.querySelectorAll("img").forEach((e=>{e.onerror=function(){this.style.display="none"}}));let y=null==(o=t.querySelector(".js-billboard"))?void 0:o.dataset.dismissalSku;localStorage&&y&&y.length>0&&(JSON.parse(localStorage.getItem("dismissal_skus_triggered"))||[]).includes(y)&&(t.style.display="none",t.innerHTML=""),r(t),a(t),e(),document.querySelectorAll(".billboard-readmore-button").forEach((e=>{e.closest(".crayons-card").querySelector(".text-styles").offsetHeight<window.innerHeight-200&&(e.closest(".crayons-card").querySelector(".text-styles").classList.remove("long-bb-body"),e.closest(".crayons-card").querySelector(".long-bb-bottom").classList.add("hidden"),e.closest(".crayons-card").querySelector(".billboard-readmore-button").classList.add("hidden")),e.addEventListener("click",(()=>{e.closest(".crayons-card").querySelector(".text-styles").classList.remove("long-bb-body"),e.closest(".crayons-card").querySelector(".long-bb-bottom").classList.add("hidden"),e.closest(".crayons-card").querySelector(".billboard-readmore-button").classList.add("hidden")}))}));let g=new Set(["class","style","data-display-unit","data-id","data-category-click","data-category-impression","data-context-type","data-special","data-article-id","data-impression-recorded","data-type-of"]),f={attributes:!0};document.querySelectorAll(".js-billboard").forEach(s),new MutationObserver((e=>{e.forEach((e=>{"childList"===e.type&&e.addedNodes.forEach((e=>{e.nodeType===Node.ELEMENT_NODE&&(e.matches(".js-billboard")&&s(e),e.querySelectorAll&&e.querySelectorAll(".js-billboard").forEach(s))}))}))})).observe(document.body,{childList:!0,subtree:!0}),i()}catch(e){/NetworkError/i.test(e.message)||Honeybadger.notify(e)}}var b=Object.create,m=Object.defineProperty,p=Object.getOwnPropertyDescriptor,y=Object.getOwnPropertyNames,g=Object.getPrototypeOf,f=Object.prototype.hasOwnProperty,v=(e,t,o,n)=>{if(t&&"object"==typeof t||"function"==typeof t)for(let r of y(t))!f.call(e,r)&&r!==o&&m(e,r,{get:()=>t[r],enumerable:!(n=p(t,r))||n.enumerable});return e},h=(((e,t,o)=>{o=null!=e?b(g(e)):{},v(!t&&e&&e.__esModule?o:m(o,"default",{value:e,enumerable:!0}),e)})(((e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports))(((e,t)=>{function o(e,t,o){function r(t){var o=y,n=g;return y=g=void 0,_=t,v=e.apply(n,o)}function a(e){return _=e,S=setTimeout(c,t),k?r(e):v}function d(e){var o=t-(e-I);return O?E(o,f-(e-_)):o}function s(e){var o=e-I;return void 0===I||o>=t||o<0||O&&e-_>=f}function c(){var e=w();if(s(e))return u(e);S=setTimeout(c,d(e))}function u(e){return S=void 0,x&&y?r(e):(y=g=void 0,v)}function b(){void 0!==S&&clearTimeout(S),_=0,y=I=g=S=void 0}function m(){return void 0===S?v:u(w())}function p(){var e=w(),o=s(e);if(y=arguments,g=this,I=e,o){if(void 0===S)return a(I);if(O)return S=setTimeout(c,t),r(I)}return void 0===S&&(S=setTimeout(c,t)),v}var y,g,f,v,S,I,_=0,k=!1,O=!1,x=!0;if("function"!=typeof e)throw new TypeError(l);return t=i(t)||0,n(o)&&(k=!!o.leading,f=(O="maxWait"in o)?h(i(o.maxWait)||0,t):f,x="trailing"in o?!!o.trailing:x),p.cancel=b,p.flush=m,p}function n(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function r(e){return!!e&&"object"==typeof e}function a(e){return"symbol"==typeof e||r(e)&&v.call(e)==s}function i(e){if("number"==typeof e)return e;if(a(e))return d;if(n(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=n(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(c,"");var o=b.test(e);return o||m.test(e)?p(e.slice(2),o?2:8):u.test(e)?d:+e}var l="Expected a function",d=NaN,s="[object Symbol]",c=/^\s+|\s+$/g,u=/^[-+]0x[0-9a-f]+$/i,b=/^0b[01]+$/i,m=/^0o[0-7]+$/i,p=parseInt,y="object"==typeof window&&window&&window.Object===Object&&window,g="object"==typeof self&&self&&self.Object===Object&&self,f=y||g||Function("return this")(),v=Object.prototype.toString,h=Math.max,E=Math.min,w=function(){return f.Date.now()};t.exports=o}))()),'button, [href], input:not([type="hidden"]), select, textarea, [tabindex="0"]'),E=({triggerElementId:e,dropdownContentId:t})=>{var o;let n=document.getElementById(t);document.getElementById(e).setAttribute("aria-expanded","true"),n.style.display="block",null==(o=n.querySelector(h))||o.focus()},w=({triggerElementId:e,dropdownContentId:t,onClose:o})=>{var n;let r=document.getElementById(t);r&&(null==(n=document.getElementById(e))||n.setAttribute("aria-expanded","false"),r.style.removeProperty("display"),null==o||o())},S=({triggerElementId:e,dropdownContentId:t,dropdownContentCloseButtonId:o,onClose:n,onOpen:r})=>{var a;let i=document.getElementById(e),l=document.getElementById(t);if(!i||!l||"true"===i.dataset.dropdownInitialized)return;i.setAttribute("aria-expanded","false"),i.setAttribute("aria-controls",t),i.setAttribute("aria-haspopup","true"),i.setAttribute("data-dropdown-initialized","true");let d=({key:o})=>{"Escape"===o?"true"===i.getAttribute("aria-expanded")&&(w({triggerElementId:e,dropdownContentId:t,onClose:c}),i.focus()):"Tab"===o&&(null!=l&&l.contains(document.activeElement)||w({triggerElementId:e,dropdownContentId:t,onClose:c}))},s=({target:o})=>{let n=document.getElementById(e);n&&o!==n&&!l.contains(o)&&!n.contains(o)&&(w({triggerElementId:e,dropdownContentId:t,onClose:c}),o.matches(h)||n.focus())},c=()=>{null==n||n(),document.removeEventListener("keyup",d),document.removeEventListener("click",s)};return i.addEventListener("click",(()=>{var o;"true"===(null==(o=document.getElementById(e))?void 0:o.getAttribute("aria-expanded"))?w({triggerElementId:e,dropdownContentId:t,onClose:c}):(E({triggerElementId:e,dropdownContentId:t}),null==r||r(),document.addEventListener("keyup",d),document.addEventListener("click",s))})),o&&(null==(a=document.getElementById(o))||a.addEventListener("click",(()=>{var o;w({triggerElementId:e,dropdownContentId:t,onClose:c}),null==(o=document.getElementById(e))||o.focus()}))),{closeDropdown:()=>{w({triggerElementId:e,dropdownContentId:t,onClose:c})}}};c()})();