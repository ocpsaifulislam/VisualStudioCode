"use strict";(self.__LOADABLE_LOADED_CHUNKS__=self.__LOADABLE_LOADED_CHUNKS__||[]).push([[9768],{88900:(e,n,i)=>{i.d(n,{A:()=>l});var t,a=i(96540);function o(){return o=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var i=arguments[n];for(var t in i)({}).hasOwnProperty.call(i,t)&&(e[t]=i[t])}return e},o.apply(null,arguments)}const l=function(e){return a.createElement("svg",o({xmlns:"http://www.w3.org/2000/svg",width:12,height:12,fill:"none",viewBox:"0 0 12 12"},e),t||(t=a.createElement("path",{stroke:"currentColor",strokeLinecap:"round",d:"M2.063 2.063 6 6m3.938 3.938L6 6m0 0 3.938-3.937M6 6 2.063 9.938"})))}},18037:(e,n,i)=>{i.d(n,{d:()=>t});var t={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"PublishPostMainQuery"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"postId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"postResult"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"postId"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"PostResultError_postResult"}},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Post"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"isPublished"}},{kind:"FragmentSpread",name:{kind:"Name",value:"PostPublishForm_post"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"draftResult"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"postId"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"DraftResultError_draftResult"}},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Draft"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"PostPublishForm_draft"}}]}}]}}]}},{kind:"FragmentDefinition",name:{kind:"Name",value:"UnavailableForLegalReasonsScreen_unavailableForLegalReasons"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"UnavailableForLegalReasons"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"lumenId"}}]}},{kind:"FragmentDefinition",name:{kind:"Name",value:"WithheldInCountryScreen_withheldInCountry"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"WithheldInCountry"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"lumenId"}}]}},{kind:"FragmentDefinition",name:{kind:"Name",value:"PostSettingsTags_tag"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Tag"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"__typename"}},{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"displayTitle"}},{kind:"Field",name:{kind:"Name",value:"normalizedTagSlug"}},{kind:"Field",name:{kind:"Name",value:"followerCount"}}]}},{kind:"FragmentDefinition",name:{kind:"Name",value:"PostSettingsTags_post"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Post"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"__typename"}},{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"tagsConnection"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"__typename"}},{kind:"Field",name:{kind:"Name",value:"edges"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"__typename"}},{kind:"Field",name:{kind:"Name",value:"node"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"PostSettingsTags_tag"}}]}}]}}]}}]}},{kind:"FragmentDefinition",name:{kind:"Name",value:"UpdatePostPaywall_post"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Post"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"__typename"}},{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"isLocked"}}]}},{kind:"FragmentDefinition",name:{kind:"Name",value:"PaywallPostCheckbox_post"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Post"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"isLocked"}},{kind:"FragmentSpread",name:{kind:"Name",value:"UpdatePostPaywall_post"}}]}},{kind:"FragmentDefinition",name:{kind:"Name",value:"EmailSubscribersCheckbox_post"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Post"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"isLocked"}},{kind:"Field",name:{kind:"Name",value:"isPublishToEmail"}},{kind:"Field",name:{kind:"Name",value:"creator"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"newsletterV3"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"subscribersCount"}}]}}]}}]}},{kind:"FragmentDefinition",name:{kind:"Name",value:"getStoryPreviewData_post"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Post"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"title"}},{kind:"Field",name:{kind:"Name",value:"extendedPreviewContent"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"subtitle"}}]}},{kind:"Field",name:{kind:"Name",value:"isPublished"}}]}},{kind:"FragmentDefinition",name:{kind:"Name",value:"StoryPreviewTitleAndSubtitle_post"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Post"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"isPublished"}},{kind:"FragmentSpread",name:{kind:"Name",value:"getStoryPreviewData_post"}}]}},{kind:"FragmentDefinition",name:{kind:"Name",value:"GridPostPreviewImage_imageMetadata"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"ImageMetadata"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"focusPercentX"}},{kind:"Field",name:{kind:"Name",value:"focusPercentY"}},{kind:"Field",name:{kind:"Name",value:"alt"}}]}},{kind:"FragmentDefinition",name:{kind:"Name",value:"getGridPostPreviewImage_post"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Post"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"previewImage"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}}]}}]}},{kind:"FragmentDefinition",name:{kind:"Name",value:"GridPostPreviewImage_post"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Post"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"title"}},{kind:"Field",name:{kind:"Name",value:"previewImage"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"GridPostPreviewImage_imageMetadata"}}]}},{kind:"FragmentSpread",name:{kind:"Name",value:"getGridPostPreviewImage_post"}}]}},{kind:"FragmentDefinition",name:{kind:"Name",value:"StoryPreviewImage_post"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Post"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"previewImage"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}}]}},{kind:"FragmentSpread",name:{kind:"Name",value:"GridPostPreviewImage_post"}}]}},{kind:"FragmentDefinition",name:{kind:"Name",value:"EditableStoryPreviewImage_post"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Post"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"previewImage"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}}]}},{kind:"FragmentSpread",name:{kind:"Name",value:"StoryPreviewImage_post"}}]}},{kind:"FragmentDefinition",name:{kind:"Name",value:"PublishStoryPreview_post"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Post"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"StoryPreviewTitleAndSubtitle_post"}},{kind:"FragmentSpread",name:{kind:"Name",value:"EditableStoryPreviewImage_post"}}]}},{kind:"FragmentDefinition",name:{kind:"Name",value:"SubmissionForm_post"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Post"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"title"}},{kind:"Field",name:{kind:"Name",value:"isPublished"}},{kind:"Field",name:{kind:"Name",value:"creator"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"name"}}]}},{kind:"FragmentSpread",name:{kind:"Name",value:"PostSettingsTags_post"}},{kind:"FragmentSpread",name:{kind:"Name",value:"PaywallPostCheckbox_post"}},{kind:"FragmentSpread",name:{kind:"Name",value:"EmailSubscribersCheckbox_post"}},{kind:"FragmentSpread",name:{kind:"Name",value:"PublishStoryPreview_post"}}]}},{kind:"FragmentDefinition",name:{kind:"Name",value:"getStoryPreviewData_draft"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Draft"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"postId"}},{kind:"Field",name:{kind:"Name",value:"title"}},{kind:"Field",name:{kind:"Name",value:"subtitle"}}]}},{kind:"FragmentDefinition",name:{kind:"Name",value:"StoryPreviewTitleAndSubtitle_draft"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Draft"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"getStoryPreviewData_draft"}}]}},{kind:"FragmentDefinition",name:{kind:"Name",value:"StoryPreviewImageSelector_draft"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Draft"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"imageIds"}}]}},{kind:"FragmentDefinition",name:{kind:"Name",value:"EditableStoryPreviewImage_draft"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Draft"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"StoryPreviewImageSelector_draft"}}]}},{kind:"FragmentDefinition",name:{kind:"Name",value:"PublishStoryPreview_draft"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Draft"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"StoryPreviewTitleAndSubtitle_draft"}},{kind:"FragmentSpread",name:{kind:"Name",value:"EditableStoryPreviewImage_draft"}}]}},{kind:"FragmentDefinition",name:{kind:"Name",value:"SubmissionForm_draft"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Draft"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"PublishStoryPreview_draft"}}]}},{kind:"FragmentDefinition",name:{kind:"Name",value:"PostResultError_postResult"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"PostResult"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"__typename"}},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Post"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}}]}},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"UnavailableForLegalReasons"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"UnavailableForLegalReasonsScreen_unavailableForLegalReasons"}}]}},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"WithheldInCountry"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"WithheldInCountryScreen_withheldInCountry"}}]}}]}},{kind:"FragmentDefinition",name:{kind:"Name",value:"PostPublishForm_post"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Post"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"SubmissionForm_post"}}]}},{kind:"FragmentDefinition",name:{kind:"Name",value:"DraftResultError_draftResult"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"DraftResult"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"__typename"}}]}},{kind:"FragmentDefinition",name:{kind:"Name",value:"PostPublishForm_draft"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Draft"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"SubmissionForm_draft"}}]}}]}},40199:(e,n,i)=>{i.d(n,{Z:()=>K});var t=i(96540),a=i(56851),o=i(90280),l=i(52290),d=i(56942),r=i(5544),s=i(95420),m=i(2550),u=i(91830),c={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"UpdatePostEmailNotification"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"postId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"notifyEmailSubscribers"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"setPostDistributionSettings"},arguments:[{kind:"Argument",name:{kind:"Name",value:"input"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"postId"},value:{kind:"Variable",name:{kind:"Name",value:"postId"}}},{kind:"ObjectField",name:{kind:"Name",value:"notifyEmailSubscribers"},value:{kind:"Variable",name:{kind:"Name",value:"notifyEmailSubscribers"}}}]}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"__typename"}},{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"isPublishToEmail"}}]}}]}}]},k=i(53424),p=i(36557),v=function(e){var n,i,a=e.post,o=function(){var e=(0,m.A)().viewerId,n=(0,u.zF)(),i=(0,s.n)(c,{update:function(n,i){var t,a;"Post"===(null===(t=i.data)||void 0===t||null===(a=t.setPostDistributionSettings)||void 0===a?void 0:a.__typename)&&e&&n.modify({id:n.identify({__typename:"Post",id:i.data.setPostDistributionSettings.id}),fields:{isPublishToEmail:function(){var e,n;return!(null===(e=i.data)||void 0===e||null===(n=e.setPostDistributionSettings)||void 0===n||!n.isPublishToEmail)}}})},onError:function(){return n({message:"There was an error updating email settings for this story. Please try again later.",toastStyle:"ERROR"})}}),t=(0,r.A)(i,2),a=t[0];return{loading:t[1].loading,updatePostEmailNotifications:a}}(),d=o.updatePostEmailNotifications,v=o.loading,g=(null==a||null===(n=a.creator)||void 0===n||null===(i=n.newsletterV3)||void 0===i?void 0:i.subscribersCount)||0,f=g>=20?"".concat(g," "):"";return t.createElement(k.S,{checked:!!a.isPublishToEmail,onChange:function(){d({variables:{postId:a.id,notifyEmailSubscribers:!a.isPublishToEmail}})},textScale:"S",disabled:v,alignItems:"flex-start",hasCustomLabelContainer:!0,checkboxStyle:"SUBTLE"},t.createElement(l.a,{marginTop:"-6px"},t.createElement(p.kZ,{scale:"M",color:"DARKER"},"Notify your ",f,"subscribers"),t.createElement(l.a,{paddingTop:"4px"},t.createElement(p.kZ,{scale:"M",color:"LIGHTER"},"Subscribers are Medium readers who follow you, and have opted-in to email notifications about your stories."))))},g=i(80876),f=i(47016),S=function(e){var n=e.post,i=(0,f.G)(),a=i.canUsePaywall,o=i.loading,d=(0,g.i)({postId:n.id,isPaywalled:!!n.isLocked,showToast:!1}),r=d.addPaywall,s=d.removePaywall,m=d.updatingPaywall;return o||!a?null:t.createElement(k.S,{checked:!!n.isLocked,onChange:function(){n.isLocked?s():r()},textScale:"S",disabled:m,alignItems:"flex-start",hasCustomLabelContainer:!0,checkboxStyle:"SUBTLE"},t.createElement(l.a,{marginTop:"-6px"},t.createElement(p.kZ,{scale:"M",color:"DARKER"},"Paywall this story"),t.createElement(l.a,{paddingTop:"4px"},t.createElement(p.kZ,{scale:"M",color:"LIGHTER"},"Your story will earn under the Partner Program when read by Medium members."))))},y=i(60603),N=i(99731),b=i(10531),T=i(44402),h=i(6054),F={position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)"},E=function(){return t.createElement(l.a,{height:"200px",maxWidth:"440px",width:"100%",backgroundColor:"BASE_NORMAL"})},P=function(){return t.createElement(b.H,{numPlaceholders:1},t.createElement(E,null))},w=function(e){var n,i=e.post,a=e.toggleEditing,d=e.isLoading,r=e.isPubSubmission,s=(0,T.l)();return d?t.createElement(P,null):t.createElement(t.Fragment,null,null!==(n=i.previewImage)&&void 0!==n&&n.id?t.createElement(l.a,{position:"relative",width:"100%"},t.createElement(h.e,{post:i,scales:{xs:"M",sm:"M",md:"M",lg:"M",xl:"M"},miroImgFetchedWidth:440,aspectRatio:o.l8.FiveToEleven}),!r&&t.createElement("div",{className:s(F)},t.createElement(N.$n,{buttonStyle:"BRAND",opacity:.8,onClick:a},"Change preview image"))):t.createElement(l.a,{height:"100%",width:"100%",display:"flex",justifyContent:"center",alignItems:"center",padding:"80px 65px",backgroundColor:"neutral.secondary"},t.createElement(p.kZ,{scale:"M"},"Include a high-quality image in your story to make it more inviting to readers.")))},x=i(86527),_=i(59393),C=i(12378),I=i(90383),D={position:"relative",height:"calc(100% - 56px)",overflowY:"auto",scrollbarWidth:"thin"},A={display:"grid",gridTemplateColumns:"repeat(auto-fill, ".concat((0,C.c)(124),")"),gap:"8px",width:"100%",padding:"2px 2px 12px 24px"},R=function(e){return function(n){return{display:"block",position:"absolute",height:(0,C.c)(128),width:(0,C.c)(128),top:(0,C.c)(-2),left:(0,C.c)(-2),border:"".concat((0,C.c)(2)," solid ").concat(e?n.colorTokens.border.accent.primary.base:"transparent"),cursor:"pointer",":hover":{borderColor:e?n.colorTokens.border.accent.primary.base:n.colorTokens.border.neutral.secondary.base}}}},L=function(e){var n=e.imageId,i=e.isSelected,a=e.onClick,d=(0,T.l)();return t.createElement(x.N,{onClick:function(){return a(n)}},t.createElement(l.a,{position:"relative"},t.createElement(o.pg,{miroId:n,aspectRatio:o.l8.Square,height:124,width:124,strategy:I.qY.Crop,webp:!0}),t.createElement("div",{className:d(R(i))})))},M=function(e){var n=e.currentPostPreviewId,i=e.draft,a=e.updatePreviewImage,o=e.toggleEditing,d=(0,T.l)(),s=(0,t.useState)(n),m=(0,r.A)(s,2),u=m[0],c=m[1],k=i.imageIds,p=(0,_.Z)({name:"detail",scale:"L",color:"LIGHTER"}),v=function(e){e!==u&&(c(e),a(e))};return t.createElement(l.a,{position:"relative",width:"100%",height:"100%",overflow:"hidden",backgroundColor:"neutral.secondary"},t.createElement(l.a,{padding:"24px 24px 6px"},t.createElement(x.N,{rules:p,linkStyle:"SUBTLE",onClick:o},"Done")),t.createElement("div",{className:d(D)},t.createElement("div",{className:d(A)},k.map((function(e,n){return t.createElement(L,{imageId:e,isSelected:e===u,onClick:v,key:"selectable-image-preview-".concat(n)})})))))},O=i(18037),V={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"UpdateStoryPreviewMetadataMutation"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"input"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"StageUpdatePostMetadataInput"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"stageUpdatePostMetadata"},arguments:[{kind:"Argument",name:{kind:"Name",value:"input"},value:{kind:"Variable",name:{kind:"Name",value:"input"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"__typename"}}]}}]}}]},z=function(){var e=(0,u.zF)(),n=(0,s.n)(V),i=(0,r.A)(n,2),t=i[0];return{updatePostMetadata:function(n){var i=n.postId,a=n.title,o=n.subtitle,l=n.featuredImageId,d=!!l;t({variables:{input:{targetPostId:i,title:a,subtitle:o,featuredImageId:l}},awaitRefetchQueries:d,refetchQueries:d?[O.d]:void 0,update:function(n,t){var l;"MutationSuccess"===(null===(l=t.data)||void 0===l?void 0:l.stageUpdatePostMetadata.__typename)?n.modify({id:n.identify({__typename:"Draft",postId:i}),fields:{title:function(e){return void 0===a||a===e?e:a},subtitle:function(e){return void 0===o||o===e?e:o}}}):e({toastStyle:"RETRYABLE_ERROR"})},onError:function(){return e({toastStyle:"RETRYABLE_ERROR"})}})},loading:i[1].loading}},U=function(e){var n,i=e.post,a=e.draft,o=e.isEditing,d=e.toggleEditing,r=e.isPubSubmission,s=z(),m=s.updatePostMetadata,u=s.loading,c=null===(n=i.previewImage)||void 0===n?void 0:n.id;return t.createElement(l.a,{height:o?"336px":"200px",width:"100%",display:"flex",alignItems:"center",justifyContent:"center"},!r&&c&&o?t.createElement(M,{currentPostPreviewId:c,draft:a,updatePreviewImage:function(e){e!==c&&m({postId:i.id,featuredImageId:e})},toggleEditing:d}):t.createElement(w,{post:i,toggleEditing:d,isLoading:!!u,isPubSubmission:r}))},B=i(46844),j=function(e){var n=e.isFocused,i=e.status;return function(e){var t="1px solid ".concat(function(e){var n=e.isFocused,i=e.theme;return"ERROR"===e.status?i.colorTokens.border.error.primary.base:n?i.colorTokens.border.neutral.secondary.base:i.colorTokens.border.neutral.tertiary.base}({theme:e,isFocused:n,status:i})," !important");return{backgroundColor:e.colorTokens.background.neutral.primary.base,borderStyle:"solid",borderWidth:"1px",border:"transparent",borderBottom:t,borderRadius:"0px",padding:"8px 0px",opacity:1}}},W=function(e){var n=e.initialValue,i=e.ariaLabel,a=e.textRules,o=e.scale,l=e.placeholder,d=e.onBlur,s=e.isEditable,m=e.isLoading,u=e.characterCountLimit,c=e.errorMessage,k=(0,t.useState)(n),p=(0,r.A)(k,2),v=p[0],g=p[1];return t.createElement(B.A,{ariaLabel:i,value:v,isMultiline:!0,scale:o,textRules:a,placeholder:l,onChange:function(e){var n=e.target.value;n.length<=u&&g(n)},onBlur:function(){v!==n&&d(v)},status:c?"ERROR":void 0,description:c,characterCountLimit:s?u:void 0,customFieldsRulesFn:j,isEditable:s&&!m,inheritCustomStyleSheet:!0,bottomContentMarginTop:"4px",keepBottomContentSpace:!0})},Z=function(e){var n=e.post,i=e.draft,a=e.isPubSubmission,o=n.isPublished,l=function(e){var n,i=e.post,t=e.draft,a=i.isPublished,o=i.title,l=i.extendedPreviewContent,d=t.title,r=t.subtitle,s=null!==(n=null==l?void 0:l.subtitle)&&void 0!==n?n:null;return{title:a?o:d,subtitle:a?s:r}}({post:n,draft:i}),d=l.title,s=l.subtitle,m=z(),u=m.updatePostMetadata,c=m.loading,k=(0,t.useState)(!1),p=(0,r.A)(k,2),v=p[0],g=p[1],f=(0,t.useState)(!1),S=(0,r.A)(f,2),y=S[0],N=S[1],b=(0,_.Z)({name:"heading",scale:"S",fontWeight:"NORMAL",color:"NORMAL"}),T=!a&&!o;return t.createElement(t.Fragment,null,t.createElement(W,{initialValue:d||"",ariaLabel:"Story preview title",textRules:b,placeholder:"Write a preview title",onBlur:function(e){e?(v&&g(!1),u({postId:n.id,title:e})):g(!0)},isEditable:T,isLoading:!!c,characterCountLimit:100,errorMessage:v?"Please enter a title":void 0}),t.createElement(W,{initialValue:s||"",ariaLabel:"Story preview subtitle",scale:"L",placeholder:"Write a preview subtitle...",onBlur:function(e){e?(y&&N(!1),u({postId:n.id,subtitle:e})):N(!0)},isEditable:T,isLoading:!!c,characterCountLimit:140,errorMessage:y?"Please enter a subtitle":void 0}))},q=function(e){var n=e.post,i=e.draft,a=e.isPubSubmission,o=(0,y.e)(!1),s=(0,r.A)(o,4),m=s[0],u=s[3];return t.createElement(l.a,{display:"flex",flexDirection:"column",gap:"32px"},t.createElement(l.a,{display:"flex",flexDirection:"column",gap:"20px"},t.createElement(d.DZ,{scale:"XS"},"Story preview"),t.createElement(U,{post:n,draft:i,isEditing:m,toggleEditing:u,isPubSubmission:a})),t.createElement(l.a,null,!m&&t.createElement(Z,{post:n,draft:i,isPubSubmission:a}),t.createElement(l.a,{marginTop:m?"4px":"10px"},t.createElement(p.kZ,{scale:"L"},"Note: Changes here will affect how your story appears in public places like Medium’s homepage and in subscribers’ inboxes — not the contents of the story itself."))))},G=function(e){var n=e.children,i=e.maxWidth;return t.createElement(l.a,{width:{xs:"100%",sm:"100%",md:"50%",lg:"50%",xl:"50%"},maxWidth:i},n)},K=function(e){var n,i,r,s=e.post,m=e.draft,u=e.publication,c=e.isPubSubmission,k=e.children,p=(null==u?void 0:u.name)||(null===(n=s.creator)||void 0===n?void 0:n.name);return t.createElement(l.a,{display:"flex",flexDirection:{xs:"column",sm:"column",md:"row",lg:"row",xl:"row"},gap:{xs:"48px",sm:"48px",md:"80px",lg:"80px",xl:"80px"},justifyContent:"center",padding:"0px 40px"},t.createElement(G,{maxWidth:"440px"},t.createElement(q,{post:s,draft:m,isPubSubmission:c})),t.createElement(G,null,t.createElement(l.a,{display:"flex",flexDirection:"row",gap:"8px",alignItems:"center"},t.createElement(d.DZ,{scale:"XS",clamp:1},"Submitting to",(null==u||null===(i=u.avatar)||void 0===i?void 0:i.id)&&t.createElement("div",{style:{display:"inline",padding:"0px 8px",verticalAlign:"text-top"}},t.createElement(o.pg,{miroId:null===(r=u.avatar)||void 0===r?void 0:r.id,width:16,height:16,rules:{borderRadius:"2px"}})),p)),t.createElement(l.a,{display:"flex",flexDirection:"column",gap:"24px",marginTop:"20px"},t.createElement(a.l,{post:s}),t.createElement(S,{post:s}),!s.isPublished&&t.createElement(v,{post:s})),k))}},37614:(e,n,i)=>{i.d(n,{X:()=>s,f:()=>m});var t=i(96540),a=i(26365),o=i(77999),l=i(9942),d=i(60219),r=i(51260),s=function(e){return"Draft"!==(null==e?void 0:e.__typename)},m=function(e){var n=e.draftResult,i=e.postId,s=(0,r.om)();if(!n)return t.createElement(a.z,{error:new d.X});switch(n.__typename){case"Unauthorized":return t.createElement(l.r,{to:s("ShowPost",{postId:i}),replace:!0});case"NotFound":return t.createElement(o.u,null)}}},92823:(e,n,i)=>{i.d(n,{K:()=>s});var t=i(96540),a=i(36557),o=i(44402),l="×";function d(e){return{border:"none",color:e.colorTokens.foreground.neutral.secondary.base,cursor:"pointer",fontSize:"18px",lineHeight:0,marginLeft:"4px",padding:0,":hover":{color:e.colorTokens.foreground.neutral.primary.hover},":focus":{color:e.colorTokens.foreground.neutral.primary.hover}}}function r(e){return{display:"inline-flex",alignItems:"center",border:"1px ".concat(e.borderStyle," ").concat(e.colorTokens.border.neutral.primary.base),borderRadius:"".concat(e.borderRadius.regular,"px"),marginRight:"".concat(2*e.grid.xStep,"px"),padding:"6px 8px",position:"relative",whiteSpace:"nowrap"}}function s(e){var n=e.isDismissable,i=void 0===n||n,s=e.label,m=e.onDismiss,u=(0,o.l)();return t.createElement("span",{className:u(r)},t.createElement(a.kZ,{color:"DARKER",scale:"M"},s),i&&t.createElement("button",{onClick:m,className:u(d)},l))}},2945:(e,n,i)=>{i.d(n,{c:()=>l,q:()=>o});var t=i(96540),a=i(34317),o=t.createContext({postId:null,viewerIsCollectionAdmin:!1,isInCollection:!1,isPublished:!1,viewerIsAuthor:!1,viewerIsEditor:!1});function l(e){var n,i,l=e.children,d=e.post,r=e.viewer,s=(0,a.$L)(),m=!!(d.creator&&r&&r.id)&&d.creator.id===r.id,u=!!(null!=d&&null!==(n=d.collection)&&void 0!==n&&n.viewerEdge.isEditor||null!=d&&null!==(i=d.pendingCollection)&&void 0!==i&&i.viewerEdge.isEditor),c=d.id,k=d.isPublished,p=!!d.collection||!!d.pendingCollection,v=r&&d.collection&&d.collection.creator&&d.collection.creator.id===r.id,g=r&&d.pendingCollection&&d.pendingCollection.creator&&d.pendingCollection.creator.id===r.id,f=!1;(u||v||g)&&(f=!0);var S={postId:c,viewerIsCollectionAdmin:f,isInCollection:p,isPublished:!!k,viewerIsAuthor:m,viewerIsEditor:u};return t.useEffect((function(){s.event("postSettings.viewed",S)}),[]),t.createElement(o.Provider,{value:S},l)}},56851:(e,n,i)=>{i.d(n,{l:()=>W});var t=i(5544),a=i(95420),o=i(96540),l=i(2945),d=i(60436),r=i(70111),s=i(14782),m=i(24960),u=i(36557),c=i(44402),k=i(27715),p=function(e){return function(n){return{border:"none",margin:0,textAlign:"left",webkitAppearance:"none",background:null,color:e?n.colorTokens.foreground.neutral.primary.base:n.colorTokens.foreground.neutral.secondary.base,cursor:"pointer",padding:"".concat(2*n.grid.yStep,"px ").concat(5*n.grid.xStep,"px"),width:"100%",":focus":{outline:"none"}}}},v=function(e){return function(n){return{color:e?n.colorTokens.foreground.neutral.primary.base:n.colorTokens.foreground.neutral.secondary.base}}};function g(e){var n=e.ariaId,i=e.onSelect,t=e.selectedTagIndex,a=e.setSelectedTagIndex,l=e.children,d=e.tags,r=e.noPortal,g=void 0!==r&&r,f=(0,c.l)();return(0,o.useEffect)((function(){var e=function(e){var n,i;"ArrowDown"===e.key&&(n="number"!=typeof t||t===d.length-1?0:t+1,a(n)),"ArrowUp"===e.key&&(i="number"!=typeof t||0===t?d.length-1:t-1,a(i))};return window.addEventListener("keyup",e),function(){window.removeEventListener("keyup",e)}}),[t]),o.createElement(m.A,{ariaId:n,isVisible:!!d.length,noArrow:!0,noPortal:g,placement:"bottom-start",referenceWidth:"100%",popoverRenderFn:function(){return o.createElement(s.Ni,null,d.map((function(e,n){var l=e.displayTitle,r=e.followerCount,s=n===t;return o.createElement("button",{className:f(p(s)),key:n,onClick:function(){return i(d[n])},onMouseEnter:function(){return a(n)},onMouseLeave:function(){return a(null)}},o.createElement(u.kZ,{scale:"M"},o.createElement("span",{className:f(v(s))},l," ",r&&r>0?"(".concat((0,k.Ct)(r),")"):"")))})))}},l)}var f=i(52290),S=i(59393),y=i(88900),N={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"TagsMultiSelectFieldQuery"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"prefix"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"includeNormalized"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"tagsTypeahead"},arguments:[{kind:"Argument",name:{kind:"Name",value:"prefix"},value:{kind:"Variable",name:{kind:"Name",value:"prefix"}}},{kind:"Argument",name:{kind:"Name",value:"includeNormalized"},value:{kind:"Variable",name:{kind:"Name",value:"includeNormalized"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"__typename"}},{kind:"FragmentSpread",name:{kind:"Name",value:"TagsMultiSelectField_tag"}}]}}]}},{kind:"FragmentDefinition",name:{kind:"Name",value:"TagsMultiSelectField_tag"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Tag"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"__typename"}},{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"displayTitle"}},{kind:"Field",name:{kind:"Name",value:"normalizedTagSlug"}},{kind:"Field",name:{kind:"Name",value:"followerCount"}}]}}]},b=function(e){return{padding:"3.5px 8px 4.5px 4px",outline:"0",flexGrow:"1",width:"100px",backgroundColor:"transparent",border:"none","::placeholder":{color:e.colorTokens.foreground.neutral.secondary.base,opacity:.5}}},T=function(e){return{padding:"3.5px 8px 4.5px 10px",borderRadius:"40px",background:e.colorTokens.background.neutral.tertiary.base,border:"1px solid ".concat(e.colorTokens.border.neutral.tertiary.base),display:"flex",alignItems:"center",maxWidth:"200px",height:"28px"}},h=function(e){return{color:e.colorTokens.foreground.neutral.secondary.base,cursor:"pointer",display:"flex",padding:"0px 0px 0px 8px",alignItems:"center",border:"none","&:hover":{background:"transparent",color:e.colorTokens.foreground.neutral.secondary.hover}}},F=function(e){return{color:e.colorTokens.foreground.neutral.primary.base,paddingTop:"2px",width:"12px",height:"12px"}},E=function(e){return{padding:"8px",cursor:"text",borderRadius:"4px",backgroundColor:e.colorTokens.background.neutral.secondary.base,border:"1px solid ".concat(e.colorTokens.border.neutral.tertiary.base),minHeight:"44px"}},P=function(e){var n=e.value,i=e.onTopicsUpdated,a=e.disabled,l=void 0!==a&&a,s=e.placeholder,m=void 0===s?"Add topics...":s,k=e.limit,p=void 0===k?5:k,v=e.includeNormalized,P=void 0!==v&&v,w=e.onFocus,x=e.onBlur,_="tagMultiSelectMenu",C=(0,r.m)().query,I=(0,c.l)(),D=(0,o.useRef)(null),A=(0,o.useRef)(null),R=(0,o.useState)(""),L=(0,t.A)(R,2),M=L[0],O=L[1],V=(0,o.useState)([]),z=(0,t.A)(V,2),U=z[0],B=z[1],j=(0,o.useState)(null),W=(0,t.A)(j,2),Z=W[0],q=W[1],G=n.length>=p,K=function(){O(""),B([]),q(null)},H=function(e){if(!G){var t=e.id?{id:e.id,displayTitle:e.displayTitle,normalizedTagSlug:e.normalizedTagSlug,followerCount:e.followerCount,__typename:"Tag"}:{id:"temp_".concat(M.toLowerCase().replace(/ /g,"_")),displayTitle:M,normalizedTagSlug:"",followerCount:0,__typename:"Tag"};n.some((function(e){var n,i;return e.id===t.id||(null===(n=e.displayTitle)||void 0===n?void 0:n.toLowerCase())===(null===(i=t.displayTitle)||void 0===i?void 0:i.toLowerCase())}))||i([].concat((0,d.A)(n),[t])),K()}};(0,o.useEffect)((function(){return A.current=window.setTimeout((function(){if(M&&!G){var e=new AbortController;D.current=e;var n={signal:e.signal};C({context:{fetchOptions:n},variables:{prefix:M,includeNormalized:P},query:N}).then((function(e){var n=e.errors,i=e.loading,t=e.data.tagsTypeahead;if(!(i||n&&n.length))if(t.find((function(e){var n;return(null===(n=e.displayTitle)||void 0===n?void 0:n.toLowerCase())===M.toLowerCase()})))B((0,d.A)(t));else{var a={id:"",displayTitle:"".concat(M," (new)"),normalizedTagSlug:"",followerCount:0,__typename:"Tag"};B([a].concat((0,d.A)(t)))}}))}else U.length&&B([])}),300),function(){A.current&&clearTimeout(A.current),D&&D.current&&D.current.abort()}}),[M,G]);var Y=(0,S.Z)({name:"detail",scale:"M",color:"DARKER"});return o.createElement(g,{ariaId:_,onSelect:H,selectedTagIndex:Z,setSelectedTagIndex:q,tags:U,noPortal:!1},o.createElement("div",{className:I(E)},o.createElement(f.a,{display:"flex",flexWrap:"wrap",gap:"8px",alignItems:"center"},n.map((function(e,t){return o.createElement("div",{key:e.id||"tag-".concat(t),className:I(T)},o.createElement(u.kZ,{color:"DARKER",scale:"S",clamp:1},e.displayTitle),o.createElement("button",{type:"button",className:I(h),onClick:function(){return t=e,void i(n.filter((function(e){return e.id!==t.id})));var t},"aria-label":"Remove ".concat(e.displayTitle)},o.createElement(y.A,{className:I(F)})))})),!G&&o.createElement("input",{role:"combobox","aria-controls":_,"aria-expanded":U.length?"true":"false","aria-autocomplete":"list",className:I([b,Y]),disabled:l,onChange:function(e){G||O(e.target.value)},onKeyUp:function(e){"Enter"===e.key&&("number"==typeof Z?H(U[Z]):U.length>0&&H(U[0]))},onFocus:function(){w&&w()},onBlur:function(){x&&x(),null===Z&&K()},placeholder:0===n.length?m:"Add more topics...",value:M}))))},w=i(34317),x=i(79429),_=i(64467),C=i(61152);function I(e){return e.toLowerCase().replace(/ /g,"_")}var D=i(92823);function A(e,n){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);n&&(t=t.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),i.push.apply(i,t)}return i}function R(e){for(var n=1;n<arguments.length;n++){var i=null!=arguments[n]?arguments[n]:{};n%2?A(Object(i),!0).forEach((function(n){(0,_.A)(e,n,i[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):A(Object(i)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(i,n))}))}return e}function L(e){var n=e.removePostTag,i=e.tag;return i.displayTitle?o.createElement(D.K,{label:i.displayTitle,onDismiss:function(){return n(i)}}):null}var M=function(e){var n=e.postTags,i=e.setPostTags,t=function(e){i((function(n){return n.filter((function(n){var i=n.id;return e.id!==i}))}))};return o.createElement(o.Fragment,null,o.createElement(f.a,{marginTop:"12px"},!!n.length&&o.createElement(f.a,{display:"inline-block",marginTop:"8px"},n.map((function(e,n){return o.createElement(f.a,{key:n,display:"inline-block",marginTop:"16px"},o.createElement(L,{tag:e,removePostTag:t}))})))),o.createElement(f.a,{marginTop:"12px"},o.createElement(C.J,{onSelect:function(e,n){e&&i((function(i){var t=(0,d.A)(i),a="temp_".concat(I(n));return i.some((function(i){var t,o,l,d=i.id===e.id,r=(null===(t=i.displayTitle)||void 0===t?void 0:t.toLowerCase())===(null===(o=e.displayTitle)||void 0===o?void 0:o.toLowerCase()),s=i.id===a,m=(null===(l=i.displayTitle)||void 0===l?void 0:l.toLowerCase())===n.toLowerCase();return d||r||s||m}))||(null!=e&&e.id?t.push(R(R({},e),{},{followerCount:0,normalizedTagSlug:"",__typename:"Tag"})):t.push({displayTitle:n,id:a,followerCount:0,normalizedTagSlug:"",__typename:"Tag"})),t}))},disabled:n.length>=5})))},O=i(99731),V=function(e){return{__typename:"PostTagsConnection",edges:e.map((function(e){return{__typename:"PostTagsEdge",node:e}}))}},z=i(91830),U={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"SetPostTagsMutation"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"targetPostId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"tagNames"}},type:{kind:"NonNullType",type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"__typename"}},{kind:"Field",name:{kind:"Name",value:"setPostTags"},arguments:[{kind:"Argument",name:{kind:"Name",value:"targetPostId"},value:{kind:"Variable",name:{kind:"Name",value:"targetPostId"}}},{kind:"Argument",name:{kind:"Name",value:"tagNames"},value:{kind:"Variable",name:{kind:"Name",value:"tagNames"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"PostSettingsTags_post"}}]}}]}},{kind:"FragmentDefinition",name:{kind:"Name",value:"PostSettingsTags_tag"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Tag"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"__typename"}},{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"displayTitle"}},{kind:"Field",name:{kind:"Name",value:"normalizedTagSlug"}},{kind:"Field",name:{kind:"Name",value:"followerCount"}}]}},{kind:"FragmentDefinition",name:{kind:"Name",value:"PostSettingsTags_post"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Post"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"__typename"}},{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"tagsConnection"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"__typename"}},{kind:"Field",name:{kind:"Name",value:"edges"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"__typename"}},{kind:"Field",name:{kind:"Name",value:"node"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"PostSettingsTags_tag"}}]}}]}}]}}]}}]},B=function(e){var n,i,d=e.postTags,r=e.lastSavedTags,s=e.post,m=(n=(0,z.zF)(),i=(0,a.n)(U,{onCompleted:function(){n({message:"Tags successfully saved"})},onError:function(){n({message:"Something went wrong when saving tags",toastStyle:"ERROR"})}}),(0,t.A)(i,1)[0]),u=(0,w.$L)(),c=(0,o.useContext)(l.q),k=r.length===d.length&&d.every((function(e,n){return I(e.displayTitle)===I(r[n].displayTitle)}));return o.createElement(f.a,{marginTop:"32px"},o.createElement(O.$n,{buttonStyle:"STRONG",disabled:k,onClick:function(){u.event("postSettings.tagsSaved",c),m({variables:{targetPostId:s.id,tagNames:d.map((function(e){return e.displayTitle||""}))},optimisticResponse:{__typename:"Mutation",setPostTags:{__typename:"Post",id:s.id,tagsConnection:V(d)}}})}},"Save"))},j=i(75636),W=function(e){var n=e.post,i=(0,w.$L)(),d=(0,o.useContext)(l.q),r=(0,x.s)({onPresentedFn:function(){return i.event("postSettings.tagsViewed",d)}}),s=function(e){if(!e)return[];var n=e.edges;return n?n.map((function(e){return e.node})).filter((function(e){return null!=e})):[]}(n.tagsConnection),m=(0,o.useState)(s),c=(0,t.A)(m,2),k=c[0],p=c[1],v=(0,a.n)(U),g=(0,t.A)(v,1)[0],S=!(0,j.z)({name:"enable_submissions_v2",placeholder:!1});return o.createElement(f.a,{ref:r},o.createElement(u.kZ,{scale:"S"},S?"Add topics (up to 5) so readers know what your story is about.":"Add up to five topics to help readers find your story."),S?o.createElement(M,{postTags:k,setPostTags:p}):o.createElement(f.a,{marginTop:"12px"},o.createElement(P,{value:k,onTopicsUpdated:function(e){i.event("postSettings.tagsSaved",d),p(e),g({variables:{targetPostId:n.id,tagNames:e.map((function(e){return e.displayTitle||""}))},optimisticResponse:{__typename:"Mutation",setPostTags:{__typename:"Post",id:n.id,tagsConnection:V(e)}}})},placeholder:"Add a topic...",limit:5})),S&&o.createElement(B,{postTags:k,lastSavedTags:s,post:n}))}},61152:(e,n,i)=>{i.d(n,{J:()=>y});var t=i(60436),a=i(5544),o=i(70111),l=i(96540),d=i(14782),r=i(24960),s=i(36557),m=i(44402),u=function(e){return function(n){return{border:"none",margin:0,textAlign:"left",webkitAppearance:"none",background:e?n.colorTokens.background.accent.primary.base:null,color:e?n.colorTokens.background.neutral.primary.base:null,cursor:"pointer",padding:"".concat(2*n.grid.yStep,"px ").concat(5*n.grid.xStep,"px"),width:"100%",":focus":{background:n.colorTokens.background.accent.primary.base,outline:"none"}}}},c=function(e){return function(n){return{color:e?n.colorTokens.background.neutral.primary.base:null}}};function k(e){var n=e.ariaId,i=e.onSelect,t=e.selectedTagIndex,a=e.setSelectedTagIndex,o=e.children,k=e.tags,p=e.noPortal,v=void 0!==p&&p,g=(0,m.l)();return l.useEffect((function(){var e=function(e){var n,i;"ArrowDown"===e.key&&(n="number"!=typeof t||t===k.length-1?0:t+1,a(n)),"ArrowUp"===e.key&&(i="number"!=typeof t||0===t?k.length-1:t-1,a(i))};return window.addEventListener("keyup",e),function(){window.removeEventListener("keyup",e)}}),[t]),l.createElement(r.A,{ariaId:n,isVisible:!!k.length,noArrow:!0,noPortal:v,placement:"bottom-start",popoverRenderFn:function(){return l.createElement(d.Ni,null,k.map((function(e,n){var o=e.displayTitle,d=n===t;return l.createElement("button",{className:g(u(d)),key:n,onClick:function(){return i(k[n])},onMouseEnter:function(){return a(n)},onMouseLeave:function(){return a(null)}},l.createElement(s.kZ,{scale:"M"},l.createElement("span",{className:g(c(d))},o)))})))}},o)}var p=i(59393),v={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"TagsTypeaheadQuery"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"prefix"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"includeNormalized"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"tagsTypeahead"},arguments:[{kind:"Argument",name:{kind:"Name",value:"prefix"},value:{kind:"Variable",name:{kind:"Name",value:"prefix"}}},{kind:"Argument",name:{kind:"Name",value:"includeNormalized"},value:{kind:"Variable",name:{kind:"Name",value:"includeNormalized"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"__typename"}},{kind:"FragmentSpread",name:{kind:"Name",value:"TagsTypeahead_tag"}}]}}]}},{kind:"FragmentDefinition",name:{kind:"Name",value:"TagsTypeahead_tag"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Tag"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"__typename"}},{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"displayTitle"}},{kind:"Field",name:{kind:"Name",value:"normalizedTagSlug"}}]}}]},g=function(e){return{padding:"4px 0",outline:"0",flexGrow:"1",borderStyle:"solid",borderWidth:"0px 0px 1px 0px",borderColor:"".concat(e.colorTokens.border.neutral.tertiary.base),":focus":{borderColor:e.colorTokens.border.neutral.secondary.base},"::placeholder":{color:e.colorTokens.foreground.neutral.secondary.base,opacity:.5}}},f=function(e){return{backgroundColor:e.baseColor.background.dark,borderRadius:"4px",border:"0px",padding:"2px 8px",width:"100%",outline:"0","::placeholder":{color:e.colorTokens.foreground.neutral.secondary.base}}},S={":disabled":{display:"none"}},y=function(e){var n=e.onSelect,i=e.onFocus,d=e.onBlur,r=e.disabled,s=void 0!==r&&r,u=e.noPortal,c=void 0!==u&&u,y=e.taglike,N=void 0!==y&&y,b=e.preventNew,T=void 0!==b&&b,h=e.includeNormalized,F=void 0!==h&&h,E="tagsTypeaheadMenu",P=(0,m.l)(),w=(0,o.m)().query,x=(0,l.useRef)(null),_=(0,l.useRef)(null),C=(0,l.useState)(""),I=(0,a.A)(C,2),D=I[0],A=I[1],R=(0,l.useState)([]),L=(0,a.A)(R,2),M=L[0],O=L[1],V=(0,l.useState)(null),z=(0,a.A)(V,2),U=z[0],B=z[1],j=function(){A(""),O([]),B(null)},W=function(e){n(e,D),j()};(0,l.useEffect)((function(){return _.current=window.setTimeout((function(){if(D){var e=new AbortController;x.current=e;var n={signal:e.signal};w({context:{fetchOptions:n},variables:{prefix:D,includeNormalized:F},query:v}).then((function(e){var n=e.errors,i=e.loading,a=e.data.tagsTypeahead;if(!(i||n&&n.length))if(a.find((function(e){var n;return(null===(n=e.displayTitle)||void 0===n?void 0:n.toLowerCase())===D.toLowerCase()}))||T)O((0,t.A)(a));else{var o={id:"",displayTitle:"".concat(D," (new)"),normalizedTagSlug:"",__typename:"Tag"};O([o].concat((0,t.A)(a)))}}))}else M.length&&O([])}),300),function(){_.current&&clearTimeout(_.current),x&&x.current&&x.current.abort()}}),[D]);var Z=(0,p.Z)({name:"detail",scale:N?"S":"M",color:"DARKER"});return l.createElement(k,{ariaId:E,onSelect:W,selectedTagIndex:U,setSelectedTagIndex:B,tags:M,noPortal:c},l.createElement("input",{role:"combobox","aria-controls":E,"aria-expanded":M.length?"true":"false","aria-autocomplete":"list",className:P([N?f:g,Z,S]),disabled:s,onChange:function(e){A(e.target.value)},onKeyUp:function(e){"Enter"===e.key&&W("number"==typeof U?M[U]:M[0])},onFocus:function(){i&&i()},onBlur:function(){d&&d(),null===U&&j()},placeholder:N?"Add topic":"Add a topic...",value:D}))}}}]);
//# sourceMappingURL=https://stats.medium.build/lite/sourcemaps/9768.a85f5560.chunk.js.map